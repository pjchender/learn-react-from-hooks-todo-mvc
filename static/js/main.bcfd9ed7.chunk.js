(this["webpackJsonptodo-mvc"]=this["webpackJsonptodo-mvc"]||[]).push([[0],{27:function(e,t,n){},37:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(0),c=n.n(a),r=n(28),i=n.n(r),s=(n(37),n(10)),u=(n(27),n(3)),d=n.n(u),l=n(7),f=n(25),b=n(9),j=n(20),h=function(e){var t=e.inputValue,n=e.handleChange,a=e.handleKeyPress,c=e.handleAddTodo;return Object(o.jsxs)("div",{className:Object(j.a)("add-todo",{active:t.length>0}),children:[Object(o.jsx)("label",{className:"add-todo-icon icon",htmlFor:"add-todo-input"}),Object(o.jsx)("div",{className:"add-todo-input",children:Object(o.jsx)("input",{id:"add-todo-input",type:"text",placeholder:"\u65b0\u589e\u5de5\u4f5c",onChange:n,onKeyPress:a,value:t})}),Object(o.jsx)("div",{className:"add-todo-action",children:Object(o.jsxs)("button",{className:"btn-reset btn-add",onClick:c,children:[" ","\u65b0\u589e"," "]})})]})},p=n(11),O=n(12);function v(){var e=Object(p.a)(["\n  font-size: 14px;\n  font-weight: 300;\n  margin: 2rem 0 1rem;\n  &:hover {\n    text-decoration: underline;\n  }\n"]);return v=function(){return e},e}function x(){var e=Object(p.a)(["\n  display: flex;\n  justify-content: space-between;\n"]);return x=function(){return e},e}var g=O.a.footer(x()),m=O.a.button(v()),k=function(e){var t=e.numOfTodos,n=e.handleFBLogout;return Object(o.jsxs)(g,{children:[Object(o.jsxs)("p",{children:["\u5269\u9918\u9805\u76ee\u6578\uff1a",t]}),Object(o.jsx)(m,{className:"btn-reset",onClick:n,children:"\u767b\u51fa"})]})},w=function(){return Object(o.jsx)("header",{children:Object(o.jsx)("h3",{children:"Tasks"})})},y=function(e){var t=e.todo,n=e.handleDelete,c=e.handleSave,r=e.handleToggleIsDone,i=e.updateIsEdit,u=Object(a.useState)(t.title),d=Object(s.a)(u,2),l=d[0],f=d[1];return Object(o.jsxs)("div",{className:Object(j.a)("task-item",{done:t.isDone,edit:t.isEdit}),children:[Object(o.jsx)("div",{className:"task-item-checked",children:Object(o.jsx)("span",{className:"icon icon-checked",onClick:r(t.id)})}),Object(o.jsxs)("div",{className:"task-item-body",onDoubleClick:function(){return i({id:t.id,isEdit:!0})},children:[Object(o.jsx)("span",{className:"task-item-body-text",children:t.title}),Object(o.jsx)("input",{className:"task-item-body-input",type:"text",placeholder:"\u65b0\u589e\u5de5\u4f5c",value:l,onChange:function(e){f(e.target.value)},onKeyDown:function(e){13===e.keyCode&&0!==l.length&&c({id:t.id,title:l,isDone:t.isDone}),27===e.keyCode&&(i({id:t.id,isEdit:!1}),f(t.title))}})]}),Object(o.jsx)("div",{className:"task-item-action",children:Object(o.jsx)("button",{className:"btn-reset btn-destroy icon",onClick:n(t.id),children:" "})})]})},T=function(e){var t=e.todos,n=e.handleDelete,a=e.handleSave,c=e.handleToggleIsDone,r=e.updateIsEdit;return Object(o.jsx)("div",{className:"todos",children:t.map((function(e){return Object(o.jsx)(y,{todo:e,handleDelete:n,handleSave:a,handleToggleIsDone:c,updateIsEdit:r},e.id)}))})},C="https://todo-mvc.herokuapp.com/api/v1",D=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,o,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,o=t.isDone,e.next=3,fetch("".concat(C,"/todos/"),{method:"POST",headers:{"Content-Type":"application/json","Facebook-Client-Token":localStorage.getItem("facebookClientToken")},body:JSON.stringify({title:n,isDone:o})});case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(C,"/todos/").concat(t),{method:"DELETE",headers:{"Facebook-Client-Token":localStorage.getItem("facebookClientToken")}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,o,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=t.title,a=t.isDone,e.next=3,fetch("".concat(C,"/todos/").concat(n),{method:"PATCH",headers:{"Content-Type":"application/json","Facebook-Client-Token":localStorage.getItem("facebookClientToken")},body:JSON.stringify({title:o,isDone:a})});case 3:return c=e.sent,e.next=6,c.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e){var t=e.handleFBLogout,n=Object(a.useState)(""),c=Object(s.a)(n,2),r=c[0],i=c[1],u=Object(a.useState)([]),j=Object(s.a)(u,2),p=j[0],O=j[1],v=p.filter((function(e){return!e.isDone})).length,x=function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,D({title:r,isDone:!1});case 4:t=e.sent,O((function(e){return[].concat(Object(f.a)(e),[Object(l.a)(Object(l.a)({},t),{},{isEdit:!1})])})),i("");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"===t.key){e.next=2;break}return e.abrupt("return");case 2:if(0!==r.length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,D({title:r,isDone:!1});case 6:n=e.sent,O((function(e){return[].concat(Object(f.a)(e),[Object(l.a)(Object(l.a)({},n),{},{isEdit:!1})])})),i("");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,o,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=t.title,a=t.isDone,e.next=3,S({id:n,title:o,isDone:a});case 3:O((function(e){return e.map((function(e){return e.id!==n?e:Object(l.a)(Object(l.a)({},e),{},{title:o,isEdit:!1})}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(C,"/todos/"),{headers:{"Facebook-Client-Token":localStorage.getItem("facebookClientToken")}}).then((function(e){return e.json()}));case 2:t=e.sent,O(t.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{isEdit:!1})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(o.jsxs)("div",{children:[Object(o.jsx)(w,{}),Object(o.jsx)(h,{inputValue:r,handleChange:function(e){i(e.target.value)},handleKeyPress:g,handleAddTodo:x}),Object(o.jsx)(T,{todos:p,handleDelete:function(e){return Object(b.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:O((function(t){return t.filter((function(t){return t.id!==e}))}));case 3:case"end":return t.stop()}}),t)})))},handleSave:m,handleToggleIsDone:function(e){return Object(b.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p.find((function(t){return t.id===e})),t.next=3,S({id:e,title:n.title,isDone:!n.isDone});case 3:O((function(t){return t.map((function(t){return t.id!==e?t:Object(l.a)(Object(l.a)({},t),{},{isDone:!t.isDone})}))}));case 4:case"end":return t.stop()}}),t)})))},updateIsEdit:function(e){var t=e.id,n=e.isEdit;O((function(e){return e.map((function(e){return e.id!==t?e:Object(l.a)(Object(l.a)({},e),{},{isEdit:n})}))}))}}),Object(o.jsx)(k,{numOfTodos:v,handleFBLogout:t})]})},N=n(2);function I(){var e=Object(p.a)(["\n  background: #1877f2;\n  color: white;\n  min-width: 200px;\n  font-family: 'Noto Sans TC', sans-serif;\n  font-weight: bold;\n  padding: 6px 0;\n  margin: 2rem 0;\n\n  &:hover {\n    background: #385898;\n  }\n"]);return I=function(){return e},e}function B(){var e=Object(p.a)(["\n  text-align: center;\n  font-family: 'Noto Sans TC', sans-serif;\n  margin: 2rem 0;\n"]);return B=function(){return e},e}function L(){var e=Object(p.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return L=function(){return e},e}var P=O.a.div(L()),A=O.a.h1(B()),J=O.a.button(I()),K=function(e){var t=e.status,n=e.handleFBLogin;return"connected"===t?Object(o.jsx)(N.a,{to:"/todos"}):Object(o.jsxs)(P,{children:[Object(o.jsx)(A,{children:"\u767b\u5165 Todo"}),Object(o.jsxs)(J,{className:"btn-reset",onClick:n,children:[" ","\u4f7f\u7528 Facebook \u767b\u5165"," "]})]})},R=function(){var e=Object(a.useState)(),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(N.g)("/login");Object(a.useEffect)((function(){window.fbAsyncInit=function(){window.FB.init({appId:"904503003705537",cookie:!0,xfbml:!0,version:"v9.0"}),console.log("[fbAsyncInit] after window.FB.init"),window.FB.getLoginStatus((function(e){var t;console.log("[refreshLoginStatus]",e),c(e),localStorage.setItem("facebookClientToken",null===e||void 0===e||null===(t=e.authResponse)||void 0===t?void 0:t.accessToken)})),window.FB.AppEvents.logPageView()},function(e,t,n){var o,a=e.getElementsByTagName(t)[0];e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="https://connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(o,a))}(document,"script","facebook-jssdk")}),[]);return n?"connected"===n.status||r?Object(o.jsx)("div",{className:"app",children:Object(o.jsxs)(N.d,{children:[Object(o.jsx)(N.b,{exact:!0,path:"/",children:"connected"===n.status?Object(o.jsx)(N.a,{to:"/todos"}):Object(o.jsx)(N.a,{to:"/login"})}),Object(o.jsx)(N.b,{path:"/login",children:Object(o.jsx)(K,{handleFBLogin:function(){window.FB.login((function(e){var t;console.log("handleFBLogin",e),c(e),localStorage.setItem("facebookClientToken",null===e||void 0===e||null===(t=e.authResponse)||void 0===t?void 0:t.accessToken)}),{scope:"public_profile,email"})},status:n.status})}),Object(o.jsx)(N.b,{path:"/todos",children:Object(o.jsx)(E,{handleFBLogout:function(){window.FB.logout((function(e){var t;console.log("handleFBLogout",e),c(e),localStorage.setItem("facebookClientToken",null===e||void 0===e||null===(t=e.authResponse)||void 0===t?void 0:t.accessToken)}))}})})]})}):Object(o.jsx)(N.a,{to:"/login"}):Object(o.jsx)(o.Fragment,{})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),o(e),a(e),c(e),r(e)}))},_=n(18);i.a.render(Object(o.jsx)(c.a.StrictMode,{children:Object(o.jsx)(_.a,{children:Object(o.jsx)(R,{})})}),document.getElementById("root")),V()}},[[45,1,2]]]);
//# sourceMappingURL=main.bcfd9ed7.chunk.js.map